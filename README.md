## Задание 1 - task_1
<b>Задание:</b>
Дано 3 файла в формате json (прилагаются в архиве к заданию) - результат http-запросов к бизнес-системе. Содержимое файлов представляет из
себя неструктурированую таблицу – в отдельном свойстве “headers” находятся значения заголовков, а в свойстве “values” находятся значения ячеек
таблицы. Пордок элементов внутри “headers” не соответствует порядку элементов внутри “values”. Каждый элемент “headers” и “values” представляет
из себя объект. Необходимо по значениям свойств этих объектов понять что объединяет заголовки и значения и реализовать алгоритм, который
позволит обрабатывать подобные файлы вне зависимости от порядка расположения элементов и на выходе возвращать структуру данных, которую
можно записать в файл Excel. Для значений заголовокв Excel у элементов “headers” брать свойство “QuickInfo”, для значений ячеек у элементов
“values” использовать свойство “Text”.

<b>Требования:</b>
* Реализовать отдельный класс для парсинга файлов и отдельный класс для записи результатов в Excel.
* Использовать минимально возможный набор внешних библиотек. Для записи в Excel использовать openpyxl.
* Реализовать обработку возможных ошибок (например, отсутствие файлов json и т.д.).

<b>Результат:</b>
Полученные данные записать в один файл Excel. Результат каждого файла json должен быть на отдельном листе. 

<b>Решение:</b>
Реализованы класс PiktaJson с методом get_format_table() для получения данных из json и класс PiktaExcel с методами add_worksheet() для создания листа таблицы и create_excel() для создания самой таблицы.

<b>Пример работы:</b>
```python
from PiktaJson import PiktaJson
from PiktaExcel import PiktaExcel

# получение данных из файлов json
json1 = PiktaJson("test1.json")
json1_table = json1.get_format_table()

json2 = PiktaJson("test2.json")
json2_table = json2.get_format_table()

json3 = PiktaJson("test3.json")
json3_table = json3.get_format_table()

# создание excel таблицы
excel_path = "test1.xlsx"
ex = PiktaExcel(excel_path)
ex.create_excel()
ex.add_worksheet("1", json1_table)
ex.add_worksheet("2", json2_table)
ex.add_worksheet("3", json3_table)
```


## Задание 2 - task_2
<b>Задание:</b>
При отправке платежей в бюджетную систему РФ необходимо выполнять проверку реквизитов на сайте налоговой службы. У вас есть краткая
инструкция от бухгалтера (прилагается в архиве к заданию) как выполняется поиск реквизитов на сайте. Необходимо повторить шаги бухгалтера в
браузере и проанализировать через инструменты разработчика какие http-запросы отправляются на сервер. По результатам реализовать модуль,
который будет в качестве параметров принимать код ИФНС и код ОКТМО, выполнять http-запрос без физического открытия браузера и отдавать на
выходе массив реквизитов, которые были отправлены сервером налоговой службы.

<b>Требования:</b>
* Реализовать отдельный класс для получения реквизитов.
* Для выполнения запросов использовать библиотеку requests.
* Реализовать обработку возможных ошибок (например, ошибка сервера, некорректные входные данные и т.д.).

<b>Результат:</b>
Полученный массив реквзитов вывести в консоль.

<b>Решение:</b>
Реализован класс PiktaNalog с методом get_info(ifns, oktmmf) для получения реквизитов.

<b>Пример работы:</b>
```python
from PiktaNalog import PiktaNalog


n = PiktaNalog()

ifns = "7840"
oktmmf = "40913000"
print(n.get_info(ifns, oktmmf))
```

Console:
```bash
{
    "form": {
        "ifns": "7840",
        "npKind": "fl",
        "oktmmf": "40913000",
        "step": "1"
    },
    "ifnsDetails": {
        "ifnsAddr": ",190103,Санкт-Петербург г,,,,Лермонтовский пр-кт,47литераА,,",
        "ifnsCode": "7840",
        "ifnsComment": "Код ОКПО:15168308 Прием: Понедельник, среда с 09.00 до 18.00.
          Вторник, четверг с 09.00 до 20.00. Пятница с 09.00 до 16.45. Вторая и четвертая
          субботы месяца с 10.00 до 15.00. Без перерыва на обед.",
        "ifnsInn": "7841000026",
        "ifnsKpp": "783901001",
        "ifnsName": "Межрайонная инспекция Федеральной налоговой службы №9 по Санкт-Петербургу",
        "ifnsPhone": "812-575-17-16",
        "sprof": "78086",
        "sprou": "78086"
    },
    "nextStep": 2,
    "payeeDetails": {
        "bankBic": "014030106",
        "bankName": "СЕВЕРО-ЗАПАДНОЕ ГУ БАНКА РОССИИ//УФК по г.Санкт-Петербургу г. Санкт-Петербург",
        "correspAcc": "40102810945370000005",
        "payeeAcc": "03100643000000017200",
        "payeeInn": "7841000026",
        "payeeKpp": "783901001",
        "payeeName": "Управление Федерального казначейства по г. Санкт-Петербургу (Межрайонная
          инспекция Федеральной налоговой службы №9 по Санкт-Петербургу)"
    },
    "sprofDetails": {
        "ifnsCode": "7847",
        "sproAddr": ",191124, Санкт-Петербург г,,,, Красного Текстильщика ул, д 10-12 лит.О,,",
        "sproCode": "78086",
        "sproComment": "Прием: Понедельник, среда с 09.00 до 18.00. Вторник, четверг
          с 09.00 до 20.00. Пятница с 09.00 до 16.45. Без перерыва на обед.",
        "sproName": "Межрайонная ИФНС России №15 по Санкт-Петербургу",
        "sproPhone": "812-335-14-03"
    },
    "sprouDetails": {
        "ifnsCode": "7847",
        "sproAddr": ",191124, Санкт-Петербург г,,,, Красного Текстильщика ул, д 10-12 лит.О,,",
        "sproCode": "78086",
        "sproComment": "Прием: Понедельник, среда с 09.00 до 18.00. Вторник, четверг
          с 09.00 до 20.00. Пятница с 09.00 до 16.45. Без перерыва на обед.",
        "sproName": "Межрайонная ИФНС России №15 по Санкт-Петербургу",
        "sproPhone": "812-335-14-03"
    },
    "step": 1
}
```
 
 
## Задание 3 - task_3
<b>Задание:</b>
Дано 3 таблицы с данными (структура и данные прилагаются в архиве к заданию) – “сlients”, “products”, “orders”.
Необходимо реализовать класс с 4 публичными методами:
1. Метод, который создает базу данных, таблицы со связями и наполняет таблицы данными.
2. Метод, который возвращает результаты запроса: список клиентов с общей суммой их покупки.
3. Метод, который возвращает результаты запроса: список клиентов, которые купили телефон.
4. Метод, который возвращает результаты запроса: список товаров с количеством их заказа.

<b>Требования:</b>
* В качестве базы данных использовать sqlite.
* 1 метод не должен выполнять повторное создание базы данных и таблиц, если они уже созданы.

<b>Результат:</b>
Результаты работы методов вывести в консоль.

<b>Решение:</b>
Реализован класс PiktaDb с методами:
1. init_db() - метод создает базу данных, таблицы со связями и наполняет таблицы данными;
2. get_clients_amount() - метод возвращает результаты запроса: список клиентов с общей суммой их покупки;
3. get_who_bought_phone() - метод возвращает результаты запроса: список клиентов, которые купили телефон;
4. get_products_order_quantity() - метод возвращает результаты запроса: список товаров с количеством их заказа


<b>Пример работы:</b>
```python
from PiktaDb import PiktaDb


p = PiktaDb(db_path="pikta_test.db")


# Метод, который создает базу данных, таблицы со связями и наполняет таблицы данными
# p.init_db(add_data=True)          # наполняет таблицы данными
p.init_db()             # не наполняет таблицы данными


# Метод, который возвращает результаты запроса: список клиентов с общей суммой их покупки
print("\tCписок клиентов с общей суммой их покупки:")
clients_amount = p.get_clients_amount()
for amount in clients_amount:
    print(f"{amount['client_name']} - {amount['amount']}")


# Метод, который возвращает результаты запроса: список клиентов, которые купили телефон
print("\n\tCписок клиентов, которые купили телефон:")
who_bought_phone = p.get_who_bought_phone()
for client in who_bought_phone:
    print(f"{client['client_name']}")


# Метод, который возвращает результаты запроса: список товаров с количеством их заказа
print("\n\tCписок товаров с количеством их заказа:")
products = p.get_products_order_quantity()
for product in products:
    print(f"{product['product_name']} - {product['orders_count']}")
```

Console:
```bash
	Cписок клиентов с общей суммой их покупки:
Александр - 9999.9
Дмитрий - 318.87
Иван - 10636.76
Константин - 10317.89

	Cписок клиентов, которые купили телефон:
Константин
Александр
Иван

	Cписок товаров с количеством их заказа:
Кофе - 2
Кружка - 2
Мяч - 2
Ручка - 2
Телефон - 3
```
